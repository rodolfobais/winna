<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>Size and Color option display For 2.3.x</name>
    <version>2.0</version>
    <code>size_color_option_display</code>
    <author>Rishabh Thakur</author>
    <link></link>
    <file path="admin/language/*/catalog/option.php">
        <operation>
            <search><![CDATA[$_['entry_type']]]></search>
            <add position="before"><![CDATA[$_['entry_display_type']  = 'Option Display Type';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['text_checkbox']]]></search>
            <add position="after"><![CDATA[$_['text_image']          = 'Image';]]></add>
        </operation> 
    </file> 

    <file path="admin/controller/catalog/option.php">
        <operation>
            <search><![CDATA[public function index() {]]></search>
            <add position="after"><![CDATA[     if ($this->db->query('SHOW COLUMNS FROM `' . DB_PREFIX . 'option` LIKE "display_type"')->num_rows == 0) {
            $this->db->query("ALTER TABLE `" . DB_PREFIX . "option` ADD `display_type` INT(3) NOT NULL DEFAULT '0' COMMENT '0 = Default, 1 = Box' AFTER `type`");
        }]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['entry_type'] = $this->language->get('entry_type');]]></search>
            <add position="after"><![CDATA[     $data['entry_display_type'] = $this->language->get('entry_display_type');]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['text_checkbox'] = $this->language->get('text_checkbox');]]></search>
            <add position="after"><![CDATA[     $data['text_image'] = $this->language->get('text_image');]]></add>
        </operation>
        <operation>
            <search><![CDATA[if (isset($this->request->post['sort_order'])) {]]></search>
            <add position="before"><![CDATA[
                if (isset($this->request->post['display_type'])) {
                    $data['display_type'] = $this->request->post['display_type'];
                } elseif (!empty($option_info)) {
                    $data['display_type'] = $option_info['display_type'];
                } else {
                    $data['display_type'] = '0';
                }
                ]]></add>
        </operation>
    </file>
    <file path="admin/model/catalog/option.php">
        <operation>
            <search><![CDATA[type = '" . $this->db->escape($data['type']) . "']]></search>
            <add position="replace"><![CDATA[type = '" . $this->db->escape($data['type']) . "', display_type = '" . $this->db->escape($data['display_type']) . "']]></add>
        </operation>        
    </file>
    <file path="admin/view/template/catalog/option_form.tpl">
        <operation>
            <search trim="true" index="0"><![CDATA[</optgroup>]]></search>
            <add position="before"><![CDATA[                <?php if ($type == 'image') { ?>
                <option value="image" selected="selected"><?php echo $text_image; ?></option>
                <?php } else { ?>
                <option value="image"><?php echo $text_image; ?></option>
                <?php } ?>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<label class="col-sm-2 control-label" for="input-sort-order"><?php echo $entry_sort_order; ?></label>]]></search>
            <add position="before"><![CDATA[            <label class="col-sm-2 control-label" for="input-display-type"><?php echo $entry_display_type; ?></label>
            <div class="col-sm-10">
              <select name="display_type" id="input-display-type" class="form-control">                
                <?php if ($display_type == '1') { ?>
                <option value="0" >Default</option>
                <option value="1" selected="selected">Size & Color View</option>
                <?php } else { ?>
                <option value="0" selected="selected">Default</option>
                <option value="1">Size & Color View</option>
                <?php } ?>                
              </select>
            </div>
          </div>
          <div class="form-group">]]></add>
        </operation>
        <operation>
            <search><![CDATA[$('#option-value').show();]]></search>
            <add position="after"><![CDATA[$('#input-display-type').closest(".form-group").show();]]></add>
        </operation>
        <operation>
            <search><![CDATA[$('#option-value').hide();]]></search>
            <add position="after"><![CDATA[$('#input-display-type').closest(".form-group").hide();]]></add>
        </operation>
    </file>

    <file path="catalog/model/catalog/product.php">
        <operation>
            <search><![CDATA[$product_option['type']]]></search>
            <add position="replace"><![CDATA[$product_option['type'], 'display_type' => $product_option['display_type']]]></add>
        </operation>
    </file>    
    <file path="catalog/controller/product/product.php">
        <operation>
            <search><![CDATA[$data['heading_title'] = $product_info['name'];]]></search>
            <add position="before"><![CDATA[            $this->document->addScript('catalog/view/sizecoloroption/size-color.min.js');
            $this->document->addStyle('catalog/view/sizecoloroption/size-color.min.css');]]></add>
        </operation>
        <operation>
            <search><![CDATA[$option['type']]]></search>
            <add position="replace"><![CDATA[$option['type'], 'display_type' => $option['display_type']]]></add>
        </operation>
    </file>
    <file path="catalog/view/theme/default/template/product/product.tpl">
        <operation>
            <search><![CDATA[<?php if ($option['type'] == 'select') { ?>]]></search>
            <add position="after"><![CDATA[            <?php if ($option['display_type'] == '1') { ?>
            <div class="form-group<?php echo ($option['required'] ? ' required' : ''); ?>">
              <label class="control-label" for="input-option<?php echo $option['product_option_id']; ?>"><?php echo $option['name']; ?></label>
              <ul class="size-color-select">
                <?php foreach ($option['product_option_value'] as $option_value) { ?>
                  <li class="boxselect" id="option-value-<?php echo $option_value['product_option_value_id']; ?>" onclick="addSelected(this,'<?php echo $option['product_option_id']; ?>','<?php echo $option_value['product_option_value_id']; ?>');"><?php echo $option_value['name']; ?></li>
                <?php } ?>
              </ul>
              <select name="option[<?php echo $option['product_option_id']; ?>]" id="input-option<?php echo $option['product_option_id']; ?>" class="form-control hide-field">
                <option value=""><?php echo $text_select; ?></option>
                <?php foreach ($option['product_option_value'] as $option_value) { ?>
                <option value="<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?>
                <?php if ($option_value['price']) { ?>
                (<?php echo $option_value['price_prefix']; ?><?php echo $option_value['price']; ?>)
                <?php } ?>
                </option>
                <?php } ?>
              </select>
            </div>            
            <?php }else{ ?>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<?php if ($option['type'] == 'radio') { ?>]]></search>
            <add position="before"><![CDATA[            <?php } ?>]]></add>
        </operation>          
        <operation>
            <search><![CDATA[<?php if ($option['type'] == 'radio') { ?>]]></search>
            <add position="after"><![CDATA[            <?php if ($option['display_type'] == '1') { ?>
            <div class="form-group<?php echo ($option['required'] ? ' required' : ''); ?>">
              <label class="control-label"><?php echo $option['name']; ?></label>
              <div class="size-color" id="input-option<?php echo $option['product_option_id']; ?>">
                <?php foreach ($option['product_option_value'] as $option_value) { ?>
                <input type="radio" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value-<?php echo $option_value['product_option_value_id']; ?>" class="hide-field" />                
                  <label for="option-value-<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?></label>
                <?php } ?>
              </div>
            </div>          
            <?php }else{ ?>]]></add>
        </operation>
        <operation>
            <search><![CDATA[<?php if ($option['type'] == 'checkbox') { ?>]]></search>
            <add position="before"><![CDATA[            <?php } ?>]]></add>
        </operation>        
        <operation>
            <search><![CDATA[<?php if ($option['type'] == 'checkbox') { ?>]]></search>
            <add position="after"><![CDATA[            <?php if ($option['display_type'] == '1') { ?>
            <div class="form-group<?php echo ($option['required'] ? ' required' : ''); ?>">
              <label class="control-label"><?php echo $option['name']; ?></label>
              <div class="size-color" id="input-option<?php echo $option['product_option_id']; ?>">
                <?php foreach ($option['product_option_value'] as $option_value) { ?>
                <input type="checkbox" name="option[<?php echo $option['product_option_id']; ?>][]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value-<?php echo $option_value['product_option_value_id']; ?>" class="hide-field" />                
                  <label for="option-value-<?php echo $option_value['product_option_value_id']; ?>"><?php echo $option_value['name']; ?></label>
                <?php } ?>
              </div>
            </div>            
            <?php }else{ ?>]]></add>
        </operation>        
        <operation>
            <search><![CDATA[<?php if ($option['type'] == 'text') { ?>]]></search>
            <add position="before"><![CDATA[            <?php } ?>
                <?php if ($option['type'] == 'image') { ?>
                <?php if ($option['display_type'] == '1') { ?>
            <div class="form-group<?php echo ($option['required'] ? ' required' : ''); ?>">
              <label class="control-label"><?php echo $option['name']; ?></label>
              <div class="size-color" id="input-option<?php echo $option['product_option_id']; ?>">
                <?php foreach ($option['product_option_value'] as $option_value) { ?>
                <label for="option-value-<?php echo $option_value['product_option_value_id']; ?>"><input type="radio" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option_value['product_option_value_id']; ?>" id="option-value-<?php echo $option_value['product_option_value_id']; ?>" class="hide-field" />
                <img src="<?php echo $option_value['image']; ?>" alt="<?php echo $option_value['name'] . ($option_value['price'] ? ' ' . $option_value['price_prefix'] . $option_value['price'] : ''); ?>" title="<?php echo $option_value['name'] . ($option_value['price'] ? ' ' . $option_value['price_prefix'] . $option_value['price'] : ''); ?>" id="image-option-<?php echo $option_value['product_option_value_id']; ?>" onclick="imageSelected(this,'<?php echo $option['product_option_id']; ?>','<?php echo $option_value['product_option_value_id']; ?>');" class="img-thumbnail boximage"  /></label>
                <?php } ?>
              </div>
            </div>            
            <?php }else{ ?>
            <div class="form-group<?php echo ($option['required'] ? ' required' : ''); ?>">
              <label class="control-label"><?php echo $option['name']; ?></label>
              <div id="input-option<?php echo $option['product_option_id']; ?>">
                <?php foreach ($option['product_option_value'] as $option_value) { ?>
                <div class="radio">
                  <label>
                    <input type="radio" name="option[<?php echo $option['product_option_id']; ?>]" value="<?php echo $option_value['product_option_value_id']; ?>" />
                    <img src="<?php echo $option_value['image']; ?>" alt="<?php echo $option_value['name'] . ($option_value['price'] ? ' ' . $option_value['price_prefix'] . $option_value['price'] : ''); ?>" title="<?php echo $option_value['name'] . ($option_value['price'] ? ' ' . $option_value['price_prefix'] . $option_value['price'] : ''); ?>" class="img-thumbnail" /> <?php echo $option_value['name']; ?>
                    <?php if ($option_value['price']) { ?>
                    (<?php echo $option_value['price_prefix']; ?><?php echo $option_value['price']; ?>)
                    <?php } ?>
                  </label>
                </div>
                <?php } ?>
              </div>
            </div>
            <?php } ?>
            <?php } ?>]]></add>
        </operation>         
    </file>  
    <file path="system/library/cart/cart.php">
        <operation>
            <search><![CDATA[if ($option_query->row['type'] == 'select' || $option_query->row['type'] == 'radio')]]></search>
            <add position="replace"><![CDATA[if ($option_query->row['type'] == 'select' || $option_query->row['type'] == 'radio' || $option_query->row['type'] == 'image')]]></add>
        </operation>        
    </file>

</modification>